editEquipment(index) {
                const equipment = this.equipmentData[index];
                const newName = prompt('Enter new equipment name:', equipment.name);
                if (newName && newName.trim()) {
                    equipment.name = newName.trim();
                    this.refreshEquipmentList();
                    this.updateDashboard();
                    this.updateCharts();
                    this.updateSensorDisplay();
                }
            }

            deleteEquipment(index) {
                if (confirm('Are you sure you want to delete this equipment?')) {
                    this.equipmentData.splice(index, 1);
                    this.refreshEquipmentList();
                    this.updateDashboard();
                    this.updateCharts();
                    this.updateSensorDisplay();
                    console.log(`Equipment at index ${index} deleted successfully`);
                }
            }<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NUROGENSIS - Predictive Maintenance System</title>
    <meta name="description" content="Professional predictive maintenance system for industrial equipment monitoring and management">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🔧</text></svg>">
    
    <!-- External Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <style>
        /* NUROGENSIS Predictive Maintenance System Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            color: #ecf0f1;
        }

        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            transition: opacity 0.5s ease;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(44, 62, 80, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            text-align: center;
            border: 1px solid rgba(236, 240, 241, 0.1);
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        nav {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-btn:hover, .nav-btn.active {
            background: linear-gradient(45deg, #2980b9, #3498db);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }

        .section {
            display: none;
            background: rgba(44, 62, 80, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(236, 240, 241, 0.1);
        }

        .section.active {
            display: block;
        }

        .section h2 {
            color: #ecf0f1;
            margin-bottom: 30px;
            font-size: 2em;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            border-left: 5px solid #3498db;
            transition: all 0.3s ease;
            color: #ecf0f1;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            color: #bdc3c7;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            color: #ecf0f1;
        }

        .active-stat { color: #27ae60; }
        .warning-stat { color: #f39c12; }
        .predictive-stat { color: #e74c3c; }

        .chart-container {
            background: rgba(52, 73, 94, 0.9);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid rgba(236, 240, 241, 0.1);
        }

        .chart-container h3 {
            margin-bottom: 20px;
            color: #ecf0f1;
            text-align: center;
        }

        .chart-wrapper {
            width: 100%;
            max-width: 600px;
            height: 300px;
            position: relative;
        }

        .sensor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .sensor-card {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            padding: 20px;
            border-radius: 12px;
            border-left: 5px solid #3498db;
            transition: all 0.3s ease;
            color: #ecf0f1;
            border: 1px solid rgba(236, 240, 241, 0.1);
        }

        .sensor-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .sensor-value {
            font-size: 2em;
            font-weight: 700;
            margin: 10px 0;
        }

        .equipment-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            color: #bdc3c7;
            margin-bottom: 8px;
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #34495e;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #2c3e50;
            color: #ecf0f1;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
            background: #34495e;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
            color: white;
        }

        .btn-export {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-filter input,
        .search-filter select {
            padding: 10px;
            border: 2px solid #34495e;
            border-radius: 8px;
            flex: 1;
            min-width: 200px;
            background: #2c3e50;
            color: #ecf0f1;
        }

        .search-filter input:focus,
        .search-filter select:focus {
            outline: none;
            border-color: #3498db;
            background: #34495e;
        }

        .equipment-list {
            display: grid;
            gap: 15px;
        }

        .equipment-card {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            padding: 20px;
            border-radius: 12px;
            border-left: 5px solid #3498db;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #ecf0f1;
            border: 1px solid rgba(236, 240, 241, 0.1);
        }

        .equipment-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .equipment-info h4 {
            color: #ecf0f1;
            margin-bottom: 5px;
        }

        .equipment-details {
            color: #bdc3c7;
            font-size: 0.9em;
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8em;
            letter-spacing: 1px;
        }

        .status-active { background: #d5f4e6; color: #27ae60; }
        .status-maintenance { background: #fdeaa7; color: #f39c12; }
        .status-critical { background: #fadbd8; color: #e74c3c; }

        .troubleshoot-content {
            display: grid;
            gap: 20px;
        }

        .troubleshoot-item {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            padding: 25px;
            border-radius: 12px;
            border-left: 5px solid #3498db;
            transition: all 0.3s ease;
            color: #ecf0f1;
            border: 1px solid rgba(236, 240, 241, 0.1);
        }

        .troubleshoot-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .troubleshoot-item h4 {
            color: #ecf0f1;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .troubleshoot-item p {
            color: #bdc3c7;
            line-height: 1.6;
        }

        .export-section {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            color: #ecf0f1;
            border: 1px solid rgba(236, 240, 241, 0.1);
        }

        .export-section h3 {
            margin-bottom: 20px;
            color: #ecf0f1;
        }

        footer {
            background: rgba(44, 62, 80, 0.95);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            color: #bdc3c7;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(236, 240, 241, 0.1);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container { padding: 15px; }
            header h1 { font-size: 2em; }
            .nav-btn { padding: 10px 15px; font-size: 12px; }
            .equipment-form { grid-template-columns: 1fr; }
            .search-filter { flex-direction: column; }
            .search-filter input, .search-filter select { min-width: auto; }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p>Loading NUROGENSIS System...</p>
    </div>

    <div class="container">
        <header>
            <h1>🔧 NUROGENSIS - Predictive Maintenance System</h1>
            <nav>
                <button class="nav-btn active" onclick="showSection('dashboard')">Dashboard</button>
                <button class="nav-btn" onclick="showSection('predictive')">Predictive Analysis</button>
                <button class="nav-btn" onclick="showSection('register')">Register Equipment</button>
                <button class="nav-btn" onclick="showSection('manage')">Manage Equipment</button>
                <button class="nav-btn" onclick="showSection('troubleshoot')">Troubleshooting</button>
            </nav>
        </header>

        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <h2>📊 Equipment Overview</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Total Equipment</h3>
                    <span class="stat-number" id="totalEquipment">0</span>
                </div>
                <div class="stat-card">
                    <h3>Active</h3>
                    <span class="stat-number active-stat" id="activeEquipment">0</span>
                </div>
                <div class="stat-card">
                    <h3>Maintenance Due</h3>
                    <span class="stat-number warning-stat" id="maintenanceEquipment">0</span>
                </div>
                <div class="stat-card">
                    <h3>Predicted Failures</h3>
                    <span class="stat-number predictive-stat" id="predictedFailures">0</span>
                </div>
            </div>

            <div class="chart-container">
                <h3>Equipment Status Distribution</h3>
                <div class="chart-wrapper">
                    <canvas id="statusChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <h3>Equipment Health Over Time</h3>
                <div class="chart-wrapper">
                    <canvas id="healthChart"></canvas>
                </div>
            </div>

            <!-- Data Export Section -->
            <div class="export-section">
                <h3>Export Data</h3>
                <button class="btn btn-export" onclick="exportData('json')">Export JSON</button>
                <button class="btn btn-export" onclick="exportData('csv')">Export CSV</button>
            </div>
        </section>

        <!-- Predictive Analysis Section -->
        <section id="predictive" class="section">
            <h2>🔮 Predictive Analysis Dashboard</h2>
            
            <div class="sensor-grid" id="sensorGrid">
                <!-- Sensor data will be populated here -->
            </div>

            <div class="chart-container">
                <h3>Real-time Sensor Data</h3>
                <div class="chart-wrapper">
                    <canvas id="sensorChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <h3>Failure Prediction Timeline</h3>
                <div class="chart-wrapper">
                    <canvas id="predictionChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Register Equipment Section -->
        <section id="register" class="section">
            <h2>➕ Register New Equipment</h2>
            <form id="equipmentForm" class="equipment-form">
                <div class="form-group">
                    <label for="equipmentId">Equipment ID:</label>
                    <input type="text" id="equipmentId" required placeholder="e.g., EQ001">
                </div>
                
                <div class="form-group">
                    <label for="equipmentName">Equipment Name:</label>
                    <input type="text" id="equipmentName" required placeholder="e.g., Industrial Pump A1">
                </div>
                
                <div class="form-group">
                    <label for="category">Category:</label>
                    <select id="category" required>
                        <option value="">Select Category</option>
                        <option value="Manufacturing">Manufacturing</option>
                        <option value="IT">IT Equipment</option>
                        <option value="HVAC">HVAC</option>
                        <option value="Safety">Safety Equipment</option>
                        <option value="Tools">Tools</option>
                        <option value="Vehicles">Vehicles</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="location">Location:</label>
                    <input type="text" id="location" required placeholder="e.g., Factory Floor 1">
                </div>
                
                <div class="form-group">
                    <label for="purchaseDate">Purchase Date:</label>
                    <input type="date" id="purchaseDate" required>
                </div>
                
                <div class="form-group">
                    <label for="warrantyExpiry">Warranty Expiry:</label>
                    <input type="date" id="warrantyExpiry">
                </div>
                
                <div class="form-group">
                    <label for="maintenanceSchedule">Maintenance Schedule (months):</label>
                    <input type="number" id="maintenanceSchedule" min="1" max="24" required placeholder="6">
                </div>
                
                <div class="form-group">
                    <label for="status">Status:</label>
                    <select id="status" required>
                        <option value="Active">Active</option>
                        <option value="Maintenance Due">Maintenance Due</option>
                        <option value="Under Maintenance">Under Maintenance</option>
                        <option value="Out of Service">Out of Service</option>
                    </select>
                </div>
                
                <div class="form-group" style="grid-column: 1 / -1;">
                    <button type="submit" class="btn btn-primary">Register Equipment</button>
                    <button type="button" class="btn btn-secondary" onclick="clearForm()">Clear Form</button>
                </div>
            </form>
        </section>

        <!-- Manage Equipment Section -->
        <section id="manage" class="section">
            <h2>⚙️ Manage Equipment</h2>
            
            <div class="search-filter">
                <input type="text" id="searchInput" placeholder="Search equipment..." onkeyup="filterEquipment()">
                <select id="filterCategory" onchange="filterEquipment()">
                    <option value="">All Categories</option>
                    <option value="Manufacturing">Manufacturing</option>
                    <option value="IT">IT Equipment</option>
                    <option value="HVAC">HVAC</option>
                    <option value="Safety">Safety Equipment</option>
                    <option value="Tools">Tools</option>
                    <option value="Vehicles">Vehicles</option>
                </select>
                <select id="filterStatus" onchange="filterEquipment()">
                    <option value="">All Status</option>
                    <option value="Active">Active</option>
                    <option value="Maintenance Due">Maintenance Due</option>
                    <option value="Under Maintenance">Under Maintenance</option>
                    <option value="Out of Service">Out of Service</option>
                </select>
                <button class="btn btn-export" onclick="refreshEquipmentList()">Refresh</button>
            </div>

            <div class="equipment-list" id="equipmentList">
                <!-- Equipment cards will be dynamically generated here -->
            </div>
        </section>

        <!-- Troubleshooting Section -->
        <section id="troubleshoot" class="section">
            <h2>🔍 Troubleshooting Guide</h2>
            <div class="troubleshoot-content">
                <div class="troubleshoot-item">
                    <h4>🌡️ Temperature Anomalies</h4>
                    <p>High temperature readings may indicate overheating. Check ventilation systems, clean air filters, and ensure proper spacing around equipment. Consider reducing workload during peak temperature hours.</p>
                </div>
                <div class="troubleshoot-item">
                    <h4>📳 Vibration Issues</h4>
                    <p>Excessive vibration can signal mechanical wear, loose components, or imbalanced rotating parts. Inspect mounting bolts, bearings, and alignment. Schedule immediate maintenance if vibration exceeds critical thresholds.</p>
                </div>
                <div class="troubleshoot-item">
                    <h4>⚡ Power Consumption Spikes</h4>
                    <p>Unusual power consumption patterns may indicate inefficient operation or component degradation. Check electrical connections, motor efficiency, and load distribution. Consider energy audit and component replacement.</p>
                </div>
                <div class="troubleshoot-item">
                    <h4>💧 Humidity Control</h4>
                    <p>Extreme humidity levels can cause corrosion, electrical issues, or material degradation. Verify HVAC systems, check seals and gaskets, and ensure proper environmental controls are functioning.</p>
                </div>
                <div class="troubleshoot-item">
                    <h4>🔧 Predictive Maintenance Tips</h4>
                    <p>Regular monitoring and early intervention can prevent costly failures. Use sensor data trends to schedule maintenance before critical thresholds are reached. Document all maintenance activities for better prediction accuracy.</p>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <p>&copy; 2024 NUROGENSIS - Professional Predictive Maintenance System | Version 1.0.0</p>
            <p>Last Updated: <span id="lastUpdated"></span></p>
        </footer>
    </div>

    <script>
        // NUROGENSIS Predictive Maintenance System JavaScript
        let nurogensisSystemInstance = null;

        class NurogensisSystem {
            constructor() {
                console.log('Starting NurogensisSystem initialization...');
                try {
                    this.equipmentData = [];
                    this.sensorData = [];
                    this.charts = {};
                    this.intervalId = null;
                    this.temperatureData = [];
                    this.vibrationData = [];
                    this.sensorDataPoints = [];
                    
                    console.log('Properties initialized...');
                    this.initializeSystem();
                    console.log('System data initialized...');
                    this.bindEvents();
                    console.log('Events bound...');
                    this.startRealTimeUpdates();
                    console.log('Real-time updates started...');
                    
                    console.log('NurogensisSystem constructor completed successfully');
                } catch (error) {
                    console.error('Error in NurogensisSystem constructor:', error);
                    throw error;
                }
            }

            hideLoadingScreen() {
                // Loading screen is now handled in the initialization
                console.log('System ready - loading screen will be hidden automatically');
            }

            initializeSystem() {
                console.log('Initializing system data...');
                try {
                    // Initialize with sample equipment data
                    this.equipmentData = [
                        {
                            id: 'EQ001',
                            name: 'Industrial Pump A1',
                            category: 'Manufacturing',
                            location: 'Factory Floor 1',
                            status: 'Active',
                            health: 92,
                            temperature: 78,
                            vibration: 2.1,
                            pressure: 145,
                            purchaseDate: '2022-01-15',
                            maintenanceSchedule: 6
                        },
                        {
                            id: 'EQ002',
                            name: 'HVAC Unit B2',
                            category: 'HVAC',
                            location: 'Building 2',
                            status: 'Maintenance Due',
                            health: 76,
                            vibration: 3.8,
                            pressure: 132,
                            purchaseDate: '2021-08-20',
                            maintenanceSchedule: 12
                        },
                        {
                            id: 'EQ003',
                            name: 'Generator C3',
                            category: 'Manufacturing',
                            location: 'Power Plant',
                            status: 'Active',
                            health: 88,
                            temperature: 82,
                            vibration: 1.9,
                            pressure: 158,
                            purchaseDate: '2023-03-10',
                            maintenanceSchedule: 8
                        }
                    ];

                    console.log('Equipment data loaded:', this.equipmentData.length, 'items');
                    
                    // Set missing temperature for EQ002
                    this.equipmentData[1].temperature = 95;
                    
                    this.updateDashboard();
                    this.initializeCharts();
                    this.updateSensorDisplay();
                    this.refreshEquipmentList();
                    this.updateLastUpdated();
                    
                    console.log('System initialization completed successfully');
                } catch (error) {
                    console.error('Error in initializeSystem:', error);
                    throw error;
                }
            }

            bindEvents() {
                // Form submission
                document.getElementById('equipmentForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.registerEquipment();
                });

                // Update last updated time
                setInterval(() => this.updateLastUpdated(), 60000);
            }

            showSection(sectionName) {
                // Hide all sections
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Remove active class from all nav buttons
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Show selected section
                document.getElementById(sectionName).classList.add('active');
                
                // Add active class to clicked button
                event.target.classList.add('active');
            }

            updateDashboard() {
                const total = this.equipmentData.length;
                const active = this.equipmentData.filter(eq => eq.status === 'Active').length;
                const maintenance = this.equipmentData.filter(eq => eq.status === 'Maintenance Due').length;
                const predicted = this.equipmentData.filter(eq => eq.health < 80).length;

                document.getElementById('totalEquipment').textContent = total;
                document.getElementById('activeEquipment').textContent = active;
                document.getElementById('maintenanceEquipment').textContent = maintenance;
                document.getElementById('predictedFailures').textContent = predicted;
            }

            initializeCharts() {
                // Status Chart
                const statusCtx = document.getElementById('statusChart').getContext('2d');
                const statusData = this.getStatusData();
                
                this.charts.status = new Chart(statusCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Active', 'Maintenance Due', 'Under Maintenance', 'Out of Service'],
                        datasets: [{
                            data: statusData,
                            backgroundColor: ['#27ae60', '#f39c12', '#e74c3c', '#95a5a6'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });

                // Health Chart
                const healthCtx = document.getElementById('healthChart').getContext('2d');
                this.charts.health = new Chart(healthCtx, {
                    type: 'line',
                    data: {
                        labels: this.equipmentData.map(eq => eq.name),
                        datasets: [{
                            label: 'Equipment Health %',
                            data: this.equipmentData.map(eq => eq.health),
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });

                // Sensor Chart with fixed dataset size
                const sensorCtx = document.getElementById('sensorChart').getContext('2d');
                this.sensorDataPoints = Array.from({length: 20}, (_, i) => i + 1);
                this.temperatureData = this.generateRandomData(20, 70, 100);
                this.vibrationData = this.generateRandomData(20, 1, 5);
                
                this.charts.sensor = new Chart(sensorCtx, {
                    type: 'line',
                    data: {
                        labels: this.sensorDataPoints.map(point => `${point}m`),
                        datasets: [{
                            label: 'Temperature',
                            data: this.temperatureData,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            tension: 0.4
                        }, {
                            label: 'Vibration',
                            data: this.vibrationData,
                            borderColor: '#f39c12',
                            backgroundColor: 'rgba(243, 156, 18, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 750
                        },
                        scales: {
                            x: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'Time (minutes)'
                                }
                            },
                            y: {
                                display: true,
                                title: {
                                    display: true,
                                    text: 'Values'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        }
                    }
                });

                // Prediction Chart
                const predictionCtx = document.getElementById('predictionChart').getContext('2d');
                this.charts.prediction = new Chart(predictionCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                        datasets: [{
                            label: 'Predicted Failures',
                            data: [2, 1, 3, 1],
                            backgroundColor: '#e74c3c'
                        }, {
                            label: 'Maintenance Scheduled',
                            data: [5, 3, 4, 6],
                            backgroundColor: '#f39c12'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }

            getStatusData() {
                const active = this.equipmentData.filter(eq => eq.status === 'Active').length;
                const maintenance = this.equipmentData.filter(eq => eq.status === 'Maintenance Due').length;
                const underMaintenance = this.equipmentData.filter(eq => eq.status === 'Under Maintenance').length;
                const outOfService = this.equipmentData.filter(eq => eq.status === 'Out of Service').length;
                return [active, maintenance, underMaintenance, outOfService];
            }

            generateRandomData(count, min, max) {
                return Array.from({length: count}, () => Math.random() * (max - min) + min);
            }

            updateSensorDisplay() {
                const sensorGrid = document.getElementById('sensorGrid');
                sensorGrid.innerHTML = '';

                this.equipmentData.forEach(equipment => {
                    const sensorCard = document.createElement('div');
                    sensorCard.className = 'sensor-card';
                    sensorCard.innerHTML = `
                        <h4>${equipment.name}</h4>
                        <div class="sensor-value" style="color: ${this.getHealthColor(equipment.health)}">
                            ${equipment.health.toFixed(5)}%
                        </div>
                        <div>Health Score</div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #7f8c8d;">
                            Temp: ${equipment.temperature.toFixed(2)}°F | 
                            Vibration: ${equipment.vibration.toFixed(5)} mm/s
                        </div>
                    `;
                    sensorGrid.appendChild(sensorCard);
                });
            }

            getHealthColor(health) {
                if (health >= 80) return '#27ae60';
                if (health >= 60) return '#f39c12';
                return '#e74c3c';
            }

            registerEquipment() {
                const formData = {
                    id: document.getElementById('equipmentId').value,
                    name: document.getElementById('equipmentName').value,
                    category: document.getElementById('category').value,
                    location: document.getElementById('location').value,
                    purchaseDate: document.getElementById('purchaseDate').value,
                    warrantyExpiry: document.getElementById('warrantyExpiry').value,
                    maintenanceSchedule: parseInt(document.getElementById('maintenanceSchedule').value),
                    status: document.getElementById('status').value,
                    health: Math.floor(Math.random() * 40) + 60, // Random health 60-100
                    temperature: Math.floor(Math.random() * 30) + 70, // Random temp 70-100
                    vibration: Math.random() * 3 + 1, // Random vibration 1-4
                    pressure: Math.floor(Math.random() * 50) + 120 // Random pressure 120-170
                };

                // Check if equipment ID already exists
                if (this.equipmentData.some(eq => eq.id === formData.id)) {
                    alert('Equipment ID already exists! Please use a different ID.');
                    return;
                }

                this.equipmentData.push(formData);
                this.updateDashboard();
                this.updateCharts();
                this.updateSensorDisplay();
                this.refreshEquipmentList();
                
                alert('Equipment registered successfully!');
                this.clearForm();
            }

            clearForm() {
                document.getElementById('equipmentForm').reset();
            }

            refreshEquipmentList() {
                const equipmentList = document.getElementById('equipmentList');
                equipmentList.innerHTML = '';

                this.equipmentData.forEach((equipment, index) => {
                    const equipmentCard = document.createElement('div');
                    equipmentCard.className = 'equipment-card';
                    
                    const statusClass = equipment.status.toLowerCase().replace(' ', '-');
                    
                    equipmentCard.innerHTML = `
                        <div class="equipment-info">
                            <h4>${equipment.name} (${equipment.id})</h4>
                            <div class="equipment-details">
                                Category: ${equipment.category} | Location: ${equipment.location}
                            </div>
                            <div class="equipment-details">
                                Health: ${equipment.health.toFixed(5)}% | 
                                Temp: ${equipment.temperature.toFixed(2)}°F | 
                                Vibration: ${equipment.vibration.toFixed(5)} mm/s
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div class="status-badge status-${statusClass}">${equipment.status}</div>
                            <div style="margin-top: 10px;">
                                <button class="btn btn-primary" onclick="handleEditEquipment(${index})" style="padding: 5px 10px; font-size: 12px;">Edit</button>
                                <button class="btn btn-secondary" onclick="handleDeleteEquipment(${index})" style="padding: 5px 10px; font-size: 12px; background: #e74c3c;">Delete</button>
                            </div>
                        </div>
                    `;
                    
                    equipmentList.appendChild(equipmentCard);
                });
            }

            filterEquipment() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const categoryFilter = document.getElementById('filterCategory').value;
                const statusFilter = document.getElementById('filterStatus').value;

                const filtered = this.equipmentData.filter(equipment => {
                    const matchesSearch = equipment.name.toLowerCase().includes(searchTerm) || 
                                        equipment.id.toLowerCase().includes(searchTerm);
                    const matchesCategory = !categoryFilter || equipment.category === categoryFilter;
                    const matchesStatus = !statusFilter || equipment.status === statusFilter;
                    
                    return matchesSearch && matchesCategory && matchesStatus;
                });

                // Update display with filtered results
                const equipmentList = document.getElementById('equipmentList');
                equipmentList.innerHTML = '';

                filtered.forEach((equipment, index) => {
                    const equipmentCard = document.createElement('div');
                    equipmentCard.className = 'equipment-card';
                    
                    const statusClass = equipment.status.toLowerCase().replace(' ', '-');
                    
                    equipmentCard.innerHTML = `
                        <div class="equipment-info">
                            <h4>${equipment.name} (${equipment.id})</h4>
                            <div class="equipment-details">
                                Category: ${equipment.category} | Location: ${equipment.location}
                            </div>
                            <div class="equipment-details">
                                Health: ${equipment.health.toFixed(5)}% | 
                                Temp: ${equipment.temperature.toFixed(2)}°F | 
                                Vibration: ${equipment.vibration.toFixed(5)} mm/s
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div class="status-badge status-${statusClass}">${equipment.status}</div>
                        </div>
                    `;
                    
                    equipmentList.appendChild(equipmentCard);
                });
            }

            updateCharts() {
                // Update status chart
                if (this.charts.status) {
                    this.charts.status.data.datasets[0].data = this.getStatusData();
                    this.charts.status.update();
                }

                // Update health chart
                if (this.charts.health) {
                    this.charts.health.data.labels = this.equipmentData.map(eq => eq.name);
                    this.charts.health.data.datasets[0].data = this.equipmentData.map(eq => parseFloat(eq.health.toFixed(5)));
                    this.charts.health.update();
                }

                // Update sensor chart with sliding window (fixed size)
                if (this.charts.sensor) {
                    // Shift data to the left and add new data point
                    this.temperatureData.shift();
                    this.vibrationData.shift();
                    
                    // Add new random data points
                    this.temperatureData.push(Math.random() * 30 + 70); // 70-100
                    this.vibrationData.push(Math.random() * 4 + 1); // 1-5
                    
                    // Update chart data
                    this.charts.sensor.data.datasets[0].data = this.temperatureData;
                    this.charts.sensor.data.datasets[1].data = this.vibrationData;
                    this.charts.sensor.update('none'); // No animation for smoother real-time feel
                }
            }

            startRealTimeUpdates() {
                // Update sensor data every 5 seconds
                this.intervalId = setInterval(() => {
                    this.simulateRealTimeData();
                    this.updateSensorDisplay();
                    this.updateCharts();
                }, 5000);
            }

            simulateRealTimeData() {
                this.equipmentData.forEach(equipment => {
                    // Simulate small changes in sensor readings
                    equipment.temperature += (Math.random() - 0.5) * 2;
                    equipment.vibration += (Math.random() - 0.5) * 0.2;
                    equipment.pressure += (Math.random() - 0.5) * 5;
                    
                    // Keep values within realistic ranges
                    equipment.temperature = Math.max(60, Math.min(120, equipment.temperature));
                    equipment.vibration = Math.max(0.5, Math.min(6, equipment.vibration));
                    equipment.pressure = Math.max(80, Math.min(200, equipment.pressure));
                    
                    // Adjust health based on conditions
                    let healthChange = 0;
                    if (equipment.temperature > 100) healthChange -= 0.1;
                    if (equipment.vibration > 4) healthChange -= 0.2;
                    if (equipment.temperature < 85 && equipment.vibration < 2.5) healthChange += 0.05;
                    
                    equipment.health = Math.max(0, Math.min(100, equipment.health + healthChange));
                    
                    // Update status based on health
                    if (equipment.health < 60) {
                        equipment.status = 'Maintenance Due';
                    } else if (equipment.health < 80 && equipment.status !== 'Under Maintenance') {
                        if (Math.random() < 0.1) equipment.status = 'Maintenance Due';
                    }
                });
                
                // Update dashboard stats
                this.updateDashboard();
            }

            updateLastUpdated() {
                document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
            }

            exportData(format) {
                const data = {
                    timestamp: new Date().toISOString(),
                    equipmentData: this.equipmentData,
                    summary: {
                        totalEquipment: this.equipmentData.length,
                        activeEquipment: this.equipmentData.filter(eq => eq.status === 'Active').length,
                        maintenanceEquipment: this.equipmentData.filter(eq => eq.status === 'Maintenance Due').length,
                        avgHealth: (this.equipmentData.reduce((sum, eq) => sum + eq.health, 0) / this.equipmentData.length).toFixed(5)
                    }
                };

                if (format === 'json') {
                    const dataStr = JSON.stringify(data, null, 2);
                    this.downloadFile(dataStr, 'nurogensis-data.json', 'application/json');
                } else if (format === 'csv') {
                    const csvData = this.convertToCSV(this.equipmentData);
                    this.downloadFile(csvData, 'nurogensis-data.csv', 'text/csv');
                }
                
                alert(`Data exported successfully as ${format.toUpperCase()}!`);
            }

            convertToCSV(data) {
                const headers = ['ID', 'Name', 'Category', 'Location', 'Status', 'Health', 'Temperature', 'Vibration', 'Pressure', 'Purchase Date'];
                const rows = data.map(eq => [
                    eq.id, eq.name, eq.category, eq.location, eq.status, 
                    eq.health, eq.temperature, eq.vibration, eq.pressure, eq.purchaseDate
                ]);
                
                return [headers, ...rows].map(row => row.join(',')).join('\n');
            }

            downloadFile(content, filename, contentType) {
                const blob = new Blob([content], { type: contentType });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            }

            editEquipment(index) {
                const equipment = this.equipmentData[index];
                const newName = prompt('Enter new equipment name:', equipment.name);
                if (newName && newName.trim()) {
                    equipment.name = newName.trim();
                    this.refreshEquipmentList();
                    this.updateDashboard();
                    this.updateCharts();
                    this.updateSensorDisplay();
                }
            }

            deleteEquipment(index) {
                if (confirm('Are you sure you want to delete this equipment?')) {
                    this.equipmentData.splice(index, 1);
                    this.refreshEquipmentList();
                    this.updateDashboard();
                    this.updateCharts();
                    this.updateSensorDisplay();
                    console.log(`Equipment at index ${index} deleted successfully`);
                }
            }
        }

        // Global handler functions for equipment management
        function handleEditEquipment(index) {
            console.log('Edit button clicked for index:', index);
            console.log('Checking system state...');
            console.log('window.nurogensisSystem exists:', !!window.nurogensisSystem);
            
            if (window.nurogensisSystem) {
                console.log('System found, checking methods...');
                console.log('editEquipment method exists:', typeof window.nurogensisSystem.editEquipment);
                console.log('Available methods:', Object.getOwnPropertyNames(Object.getPrototypeOf(window.nurogensisSystem)));
                
                if (typeof window.nurogensisSystem.editEquipment === 'function') {
                    window.nurogensisSystem.editEquipment(index);
                } else {
                    console.error('editEquipment method not found');
                    alert('Edit function not available. Please refresh the page.');
                }
            } else {
                console.error('NUROGENSIS system not found on window object');
                alert('System not ready. Please refresh the page.');
            }
        }

        function handleDeleteEquipment(index) {
            console.log('Delete button clicked for index:', index);
            console.log('Checking system state...');
            console.log('window.nurogensisSystem exists:', !!window.nurogensisSystem);
            
            if (window.nurogensisSystem) {
                console.log('System found, checking methods...');
                console.log('deleteEquipment method exists:', typeof window.nurogensisSystem.deleteEquipment);
                console.log('Available methods:', Object.getOwnPropertyNames(Object.getPrototypeOf(window.nurogensisSystem)));
                
                if (typeof window.nurogensisSystem.deleteEquipment === 'function') {
                    window.nurogensisSystem.deleteEquipment(index);
                } else {
                    console.error('deleteEquipment method not found');
                    alert('Delete function not available. Please refresh the page.');
                }
            } else {
                console.error('NUROGENSIS system not found on window object');
                alert('System not ready. Please refresh the page.');
            }
        }

        // Attach to window for global access
        window.handleEditEquipment = handleEditEquipment;
        window.handleDeleteEquipment = handleDeleteEquipment;

        // Remove the old global functions since we're using class methods now
        // Global functions for navigation and form management
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        function clearForm() {
            document.getElementById('equipmentForm').reset();
        }

        function filterEquipment() {
            if (window.nurogensisSystem) {
                window.nurogensisSystem.filterEquipment();
            }
        }

        function refreshEquipmentList() {
            if (window.nurogensisSystem) {
                window.nurogensisSystem.refreshEquipmentList();
            }
        }

        function exportData(format) {
            if (window.nurogensisSystem) {
                window.nurogensisSystem.exportData(format);
            }
        }

        // Initialize the system when the DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, starting system initialization...');
            
            // Hide loading screen initially after a short delay
            setTimeout(() => {
                const loadingScreen = document.getElementById('loadingScreen');
                if (loadingScreen) {
                    console.log('Hiding loading screen...');
                    loadingScreen.style.opacity = '0';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 500);
                }
            }, 1500);
            
            // Initialize the system
            try {
                console.log('Creating NurogensisSystem instance...');
                nurogensisSystemInstance = new NurogensisSystem();
                window.nurogensisSystem = nurogensisSystemInstance;
                console.log('NUROGENSIS Predictive Maintenance System Initialized Successfully!');
                
            } catch (error) {
                console.error('CRITICAL ERROR: Failed to initialize NUROGENSIS system:', error);
                
                // Try to hide loading screen even if initialization fails
                const loadingScreen = document.getElementById('loadingScreen');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
                
                // Show error message to user
                document.body.innerHTML += `
                    <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                                background: #e74c3c; color: white; padding: 20px; border-radius: 10px; 
                                z-index: 10000; text-align: center;">
                        <h3>System Initialization Failed</h3>
                        <p>Please refresh the page or check console for details.</p>
                        <button onclick="location.reload()" style="background: white; color: #e74c3c; 
                                border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                            Refresh Page
                        </button>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
